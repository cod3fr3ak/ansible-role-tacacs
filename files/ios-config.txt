# These commands must be in the IOS config
aaa new-model
aaa authentication fail-message ^C

Authentication failure. This incident has been logged.

^C
#
# Authentication configuration
#
aaa authentication password-prompt "LOCAL Password: "
aaa authentication username-prompt "LOCAL Username: "
aaa authentication login default local group tacacs+
aaa authentication enable default group tacacs+ enable

# Authorization configuration
#
aaa authorization config-commands
aaa authorization exec default local group tacacs+
aaa authorization commands 0 default local group tacacs+
aaa authorization commands 1 default local group tacacs+
aaa authorization commands 15 default local group tacacs+

# Accounting Configuration
#
aaa accounting send stop-record authentication failure
aaa accounting exec default start-stop group tacacs+
aaa accounting commands 0 default start-stop group tacacs+
aaa accounting commands 1 default start-stop group tacacs+
aaa accounting commands 15 default start-stop group tacacs+

# TACACS server config for IOS < 15
#
tacacs-server host [ip] single-connection key [key]

# TACACS server config for IOS >= 15
#
tacacs server ryl_tacacs
 address ipv4 [ip]
 key 0 [key]
 single-connection

# Specify a source interface that matches the TACACS ACL
#
ip tacacs source-interface [interface]
